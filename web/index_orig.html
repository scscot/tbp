<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Build Pro - The Ultimate Team Building Platform</title>
    <link rel="stylesheet" href="css/style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <link rel="icon" href="https://img.icons8.com/plasticine/100/organization.png" type="image/png">

    <meta name="apple-itunes-app" content="app-id=YOUR_APP_ID">

    <link rel="apple-touch-icon" href="assets/icons/app_icon.png">
    
    <!-- Google Material Symbols -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <style>
        /* --- Modal Styles --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 2rem 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 400px;
            width: 90%;
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-content h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .modal-content p {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        .modal-close-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .modal-close-btn:hover {
            background: var(--primary-dark);
        }
    </style>
</head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-28LP2SPR3X"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-28LP2SPR3X');
</script>

<body>
    <header class="header">
        <nav class="nav container">
            <div class="logo">
                <span class="material-symbols-outlined" style="font-size: 32px; color: white;">groups</span>
                <span>Team Build Pro</span>
            </div>
            <div class="nav-links">
                <a href="#features">Features</a>
                <a href="#pricing">Pricing</a>
                <a href="#faq">FAQ</a>
            </div>
            <a href="#" id="cta-header" class="cta-button">Get Started Free</a>
        </nav>
    </header>

    <main>
        <section class="hero gradient-bg">
            <div class="container">
                <div class="hero-content">
                    <span class="platform-badge">The #1 Platform for Team Builders</span>
                    <h1>
                        Build Your Foundation
                    </h1>
                    <h1>
                        <span class="accent">Accelerate Your Momentum</span>
                    </h1>
                    <p>
                        The ultimate app for direct sales professionals to build, manage, and scale your
                        organization with unstoppable momentum.
                    </p>
                    <div class="hero-buttons">
                        <a href="#" id="cta-hero" class="primary-button">Start Your 30-Day Free Trial</a>
                        <a href="#features" class="secondary-button">Learn More</a>
                    </div>
                </div>
            </div>
        </section>

        <section id="features" class="section">
            <div class="container">
                <div class="section-header">
                    <h2>A Smarter Way to Build Your Team</h2>
                    <p>Team Build Pro gives you the tools to turn a cold start into a running start.</p>
                </div>

                <div class="grid grid-3">
                    <div class="feature-card reveal-on-scroll">
                        <div class="feature-icon blue">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                            </svg>
                        </div>
                        <h3>Build & Grow Globally</h3>
                        <p>Expand your team worldwide and monitor qualification progress in real-time. Get a powerful
                            head start by pre-building your team.</p>
                    </div>

                    <div class="feature-card reveal-on-scroll">
                        <div class="feature-icon purple">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                            </svg>
                        </div>
                        <h3>Powerful Insights</h3>
                        <p>Access real-time team analytics and generate comprehensive reports to track growth and
                            monitor key performance metrics instantly.</p>
                    </div>

                    <div class="feature-card reveal-on-scroll">
                        <div class="feature-icon emerald">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                            </svg>
                        </div>
                        <h3>Secure Communication</h3>
                        <p>Communicate globally with a built-in, secure messaging system. Receive daily team growth
                            updates and milestone notifications.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="section section-white">
            <div class="container">
                <div class="section-header">
                    <h2>A Simple Process for Success</h2>
                    <p>Our proven 3-step process helps you build momentum from the very beginning.</p>
                </div>

                <div class="steps">
                    <div class="step reveal-on-scroll">
                        <div class="step-number">
                            <div class="step-number-inner">1</div>
                        </div>
                        <h3>Invite & Connect</h3>
                        <p>Connect with like-minded professionals who are open to exploring your opportunity and invite
                            them to your pre-build network.</p>
                    </div>
                    <div class="step reveal-on-scroll">
                        <div class="step-number">
                            <div class="step-number-inner">2</div>
                        </div>
                        <h3>Cultivate Momentum</h3>
                        <p>Foster authentic relationships as your network grows, creating a thriving community of
                            professionals who support each other's success.</p>
                    </div>
                    <div class="step reveal-on-scroll">
                        <div class="step-number">
                            <div class="step-number-inner">3</div>
                        </div>
                        <h3>Launch with Success</h3>
                        <p>When the time is right, invite your pre-built team to join your official opportunity, turning
                            potential into performance.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="pricing" class="section">
            <div class="container">
                <div class="section-header">
                    <h2>Simple, Transparent Pricing</h2>
                    <p>One plan, all features. Start your free trial today, no credit card required.</p>
                </div>
                <div class="pricing-card">
                    <h3>Pro Plan</h3>
                    <p class="subtitle">Full access to all our premium features.</p>
                    <div class="price">
                        <span class="amount">$4.99</span>
                        <span class="period">/ month</span>
                    </div>
                    <ul class="features-list">
                        <li>
                            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                            Unlimited Team Members
                        </li>
                        <li>
                            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                            Real-time Analytics
                        </li>
                        <li>
                            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                            Secure Messaging
                        </li>
                        <li>
                            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                            Global Network Building
                        </li>
                        <li>
                            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                            24/7 Customer Support
                        </li>
                    </ul>
                    <a href="#" id="cta-pricing" class="pricing-button">Start 30-Day Free Trial</a>
                </div>
            </div>
        </section>

        <section id="faq" class="section section-white">
            <div class="container">
                <div class="section-header">
                    <h2>Frequently Asked Questions</h2>
                    <p>Have questions? We've got answers. If you have other questions, feel free to reach out.</p>
                </div>
                <div class="faq">
                    <div class="faq-item">
                        <button class="faq-button" onclick="toggleFAQ(1)">
                            <span>Is Team Build Pro a business opportunity?</span>
                            <svg class="faq-icon" id="icon-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        <div class="faq-content" id="content-1">
                            No. Team Build Pro is not a business opportunity or income platform of any kind. We are a
                            software tool designed exclusively to help professionals build and track their teams. We do
                            not provide any form of user compensation.
                        </div>
                    </div>
                    <div class="faq-item">
                        <button class="faq-button" onclick="toggleFAQ(2)">
                            <span>Who is this platform for?</span>
                            <svg class="faq-icon" id="icon-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        <div class="faq-content" id="content-2">
                            Our platform is perfect for direct sales professionals, affiliate marketers, team leaders,
                            and any entrepreneur looking to build a collaborative organization. Whether you're just
                            starting or you're a seasoned mentor, our tools scale with you.
                        </div>
                    </div>
                    <div class="faq-item">
                        <button class="faq-button" onclick="toggleFAQ(3)">
                            <span>Do I need a credit card for the free trial?</span>
                            <svg class="faq-icon" id="icon-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        <div class="faq-content" id="content-3">
                            No. You can enjoy full access to all premium features for 30 days completely free, with no
                            credit card required to start. You can decide to subscribe at any point during or after your
                            trial.
                        </div>
                    </div>
                    <div class="faq-item">
                        <button class="faq-button" onclick="toggleFAQ(4)">
                            <span>Can I cancel my subscription at any time?</span>
                            <svg class="faq-icon" id="icon-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        <div class="faq-content" id="content-4">
                            Yes. You can cancel your subscription at any time with no long-term commitments or
                            cancellation fees. You will retain access until the end of your current billing period.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="cta-section gradient-bg">
            <div class="container">
                <h2>Ready to Build Your Empire?</h2>
                <p>
                    Join thousands of professionals who are building their teams faster than ever before. Start your
                    30-day free trial today.
                </p>
                <a href="#" id="cta-final">Claim Your Free Trial</a>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-logo">
                <span class="material-symbols-outlined" style="font-size: 32px; color: white;">groups</span>
                <span>Team Build Pro</span>
            </div>
            <div class="footer-links">
    <a href="/#pricing">Pricing</a>
    <a href="/#faq">FAQ</a>
    <a href="/contact_us.html">Contact</a>
    <a href="/privacy_policy.html">Privacy Policy</a>
    <a href="/terms_of_service.html">Terms of Service</a>
</div>
            <p>&copy; <span id="currentYear"></span> Team Build Pro. All Rights Reserved.</p>
        </div>
    </footer>

    <div id="comingSoonModal" class="modal-overlay" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2>🚀 Coming Soon!</h2>
            <p>Our app is putting on the final touches and will be launching on the App Store very soon. Get ready to
                build like a pro!</p>
            <button class="modal-close-btn" onclick="closeModal()">Got it!</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA45ZN9KUuaYT0OHYZ9DmX2Jc8028Ftcvc",
            authDomain: "teambuilder-plus-fe74d.firebaseapp.com",
            projectId: "teambuilder-plus-fe74d",
            storageBucket: "teambuilder-plus-fe74d.firebasestorage.app",
            messagingSenderId: "312163687148",
            appId: "1:312163687148:web:43385dff773dab0b3763c9",
            measurementId: "G-G4E4TBBPZ7"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // FAQ Toggle Function
        function toggleFAQ(index) {
            const content = document.getElementById(`content-${index}`);
            const icon = document.getElementById(`icon-${index}`);

            // Close all other FAQs
            for (let i = 1; i <= 4; i++) {
                if (i !== index) {
                    document.getElementById(`content-${i}`).classList.remove('open');
                    document.getElementById(`icon-${i}`).classList.remove('rotated');
                }
            }

            // Toggle current FAQ
            content.classList.toggle('open');
            icon.classList.toggle('rotated');
        }

        // Function to parse referral code from URL (supports both path and query parameter)
        function getReferralCode() {
            // Handle file:// protocol for local testing
            if (window.location.protocol === 'file:') {
                console.log('Local file detected, no referral code processing');
                return null;
            }

            // First, try to get referral code from query parameter (?ref=code)
            const urlParams = new URLSearchParams(window.location.search);
            const queryRef = urlParams.get('ref');

            if (queryRef && isValidReferralCode(queryRef)) {
                console.log('Found referral code in query parameter:', queryRef);
                return queryRef;
            }

            // Fallback: try to get referral code from URL path (/code)
            const path = window.location.pathname;
            const referralCode = path.substring(1); // Remove leading slash

            // Exclude known pages and common paths from being treated as referral codes
            const excludedPaths = [
                'privacy_policy.html',
                'terms_of_service.html',
                'contact_us.html',
                'index.html',
                'index_production.html',
                '',
                'favicon.ico',
                'robots.txt',
                'sitemap.xml'
            ];

            // Also exclude paths that contain file extensions or are clearly not referral codes
            if (excludedPaths.includes(referralCode) ||
                referralCode.includes('.') ||
                referralCode.includes('/') ||
                !isValidReferralCode(referralCode)) {
                return null;
            }

            console.log('Found referral code in URL path:', referralCode);
            return referralCode;
        }

        // Function to validate referral codes (same validation as our Flutter app)
        function isValidReferralCode(referralCode) {
            if (!referralCode || referralCode.trim().length === 0) {
                return false;
            }

            // Reject codes that are too long (likely file paths)
            if (referralCode.length > 50) {
                console.log('Rejecting overly long referral code');
                return false;
            }

            // Reject codes that are too short
            if (referralCode.length < 3) {
                return false;
            }

            // Reject codes that contain file path indicators
            if (referralCode.includes('/') || referralCode.includes('\\') || referralCode.includes(':')) {
                console.log('Rejecting referral code with path indicators');
                return false;
            }

            // Reject codes that look like file paths or URLs
            if (referralCode.startsWith('file://') || referralCode.startsWith('C:') || referralCode.startsWith('/')) {
                console.log('Rejecting file path referral code');
                return false;
            }

            return true;
        }

        // Function to create and insert invite section
        function createInviteSection(firstName, lastName) {
            const inviteSection = document.createElement('div');
            inviteSection.id = 'invite-section';
            inviteSection.style.cssText = 'display: flex; justify-content: center; margin-bottom: 1.5rem; padding: 0 0.5rem;';
            inviteSection.innerHTML = `
                <p style="color: white; font-size: 1.25rem; font-weight: 500; margin: 0; text-align: center;">
                    <span style="color: white;">Welcome!</span> You were invited by 
                    <span style="font-weight: 700; color: white;">${firstName} ${lastName}</span>
                </p>`;

            // Insert just above "The #1 Platform for Team Builders"
            const heroContent = document.querySelector('.hero-content');
            const platformBadge = heroContent.querySelector('.platform-badge');
            heroContent.insertBefore(inviteSection, platformBadge);
        }

        // Function to query Firestore for user data
        async function fetchUserByReferralCode(referralCode) {
            try {
                console.log('Fetching user data for referral code:', referralCode);

                // Query by referralCode field instead of document ID
                const querySnapshot = await db.collection('users')
                    .where('referralCode', '==', referralCode)
                    .limit(1)
                    .get();

                if (!querySnapshot.empty) {
                    const userDoc = querySnapshot.docs[0];
                    const userData = userDoc.data();
                    const firstName = userData.firstName || '';
                    const lastName = userData.lastName || '';

                    if (firstName && lastName) {
                        console.log('User found:', firstName, lastName);
                        createInviteSection(firstName, lastName);
                        return { firstName, lastName };
                    } else {
                        console.log('User document exists but missing name fields');
                        return null;
                    }
                } else {
                    console.log('No user found with referral code:', referralCode);
                    return null;
                }
            } catch (error) {
                console.error('Error fetching user data:', error);
                return null;
            }
        }

        // Smart App Banner Functions

        // Function to update Smart App Banner with referral code
        function updateSmartAppBanner(referralCode) {
            const appId = 'YOUR_APP_ID'; // Replace with your actual App Store ID
            const metaTag = document.querySelector('meta[name="apple-itunes-app"]');

            if (referralCode && referralCode.trim() !== '') {
                // Update the meta tag with the referral code
                const content = `app-id=${appId}, app-argument=teambuildpro://app/?ref=${referralCode}`;
                metaTag.setAttribute('content', content);
                console.log('Smart App Banner updated with referral code:', referralCode);
            } else {
                // Default without referral code
                const content = `app-id=${appId}`;
                metaTag.setAttribute('content', content);
                console.log('Smart App Banner set without referral code');
            }
        }

        // Function to create manual App Store button (fallback for non-Safari browsers)
        function createAppStoreButton(referralCode) {
            const appId = 'YOUR_APP_ID'; // Replace with your actual App Store ID
            const appStoreUrl = `https://apps.apple.com/app/id${appId}`;

            // Create button container
            const buttonContainer = document.createElement('div');
            buttonContainer.id = 'app-store-button-container';
            buttonContainer.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 12px;
                text-align: center;
                z-index: 10000;
                font-family: 'Inter', sans-serif;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            `;

            // Create message
            const message = document.createElement('span');
            message.style.cssText = `
                font-size: 14px;
                margin-right: 12px;
            `;
            if (referralCode) {
                message.textContent = `Get the Team Build Pro app to join with referral code: ${referralCode}`;
            } else {
                message.textContent = 'Get the Team Build Pro app for the best experience';
            }

            // Create download button
            const button = document.createElement('a');
            button.href = appStoreUrl;
            button.target = '_blank';
            button.style.cssText = `
                background: rgba(255,255,255,0.2);
                color: white;
                padding: 8px 16px;
                border-radius: 20px;
                text-decoration: none;
                font-weight: 600;
                font-size: 14px;
                margin: 0 8px;
                border: 1px solid rgba(255,255,255,0.3);
                transition: all 0.3s ease;
            `;
            button.textContent = 'Download App';

            // Add hover effect
            button.addEventListener('mouseenter', () => {
                button.style.background = 'rgba(255,255,255,0.3)';
                button.style.transform = 'translateY(-1px)';
            });
            button.addEventListener('mouseleave', () => {
                button.style.background = 'rgba(255,255,255,0.2)';
                button.style.transform = 'translateY(0)';
            });

            // Create close button
            const closeButton = document.createElement('button');
            closeButton.innerHTML = '×';
            closeButton.style.cssText = `
                background: none;
                border: none;
                color: white;
                font-size: 24px;
                position: absolute;
                right: 15px;
                top: 50%;
                transform: translateY(-50%);
                cursor: pointer;
                padding: 0;
                width: 30px;
                height: 30px;
                border-radius: 50%;
                transition: background 0.3s ease;
            `;
            closeButton.addEventListener('mouseenter', () => {
                closeButton.style.background = 'rgba(255,255,255,0.2)';
            });
            closeButton.addEventListener('mouseleave', () => {
                closeButton.style.background = 'none';
            });
            closeButton.onclick = () => {
                buttonContainer.style.transform = 'translateY(-100%)';
                setTimeout(() => buttonContainer.remove(), 300);
            };

            buttonContainer.appendChild(message);
            buttonContainer.appendChild(button);
            buttonContainer.appendChild(closeButton);

            // Add slide-in animation
            buttonContainer.style.transform = 'translateY(-100%)';
            buttonContainer.style.transition = 'transform 0.3s ease';

            return buttonContainer;
        }

        // Function to detect if running on iOS Safari
        function isIOSSafari() {
            const ua = navigator.userAgent;
            const isIOS = /iPad|iPhone|iPod/.test(ua);
            const isSafari = /Safari/.test(ua) && !/Chrome|CriOS|FxiOS/.test(ua);
            return isIOS && isSafari;
        }

        // Function to detect if running on mobile device
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        // --- Modal Functions ---
        const modal = document.getElementById('comingSoonModal');

        function openModal() {
            if (modal) modal.style.display = 'flex';
        }

        function closeModal() {
            if (modal) modal.style.display = 'none';
        }

        // Close modal if escape key is pressed
        window.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });

        // Function to initialize app banner
        function initializeAppBanner(referralCode) {
            if (isIOSSafari()) {
                // Use Smart App Banner for iOS Safari
                updateSmartAppBanner(referralCode);
                console.log('Smart App Banner initialized for iOS Safari');
            } else if (isMobileDevice()) {
                // Show manual button for other mobile browsers
                const button = createAppStoreButton(referralCode);
                document.body.insertBefore(button, document.body.firstChild);

                // Trigger slide-in animation
                setTimeout(() => {
                    button.style.transform = 'translateY(0)';
                }, 100);

                console.log('Manual App Store button created for mobile browser');
            } else {
                console.log('Desktop browser detected, no app banner shown');
            }
        }

        // Function to update main CTA buttons based on device
        function updateCTAs() {
            const ctaIds = ['cta-header', 'cta-hero', 'cta-pricing', 'cta-final'];
            const isMobile = isMobileDevice();

            ctaIds.forEach(id => {
                const button = document.getElementById(id);
                if (button) {
                    if (isMobile) {
                        // On mobile, change text and set to open the modal
                        button.textContent = 'Download on the App Store';
                        button.href = 'javascript:void(0);';
                        button.target = '_self';
                        button.onclick = openModal;
                    } else {
                        // On desktop, link to the features section
                        button.href = '#features';
                        button.textContent = 'Learn More';
                        button.target = '_self';
                        button.onclick = null; // Remove the modal click handler
                    }
                }
            });

            // Special handling for the secondary hero button to avoid redundancy
            const secondaryHeroButton = document.querySelector('.hero-buttons .secondary-button');
            if (secondaryHeroButton) {
                if (isMobile) {
                    secondaryHeroButton.style.display = 'none'; // Hide on mobile
                } else {
                    secondaryHeroButton.style.display = 'none'; // ALSO hide on desktop
                }
            }
        }

        // Main initialization function
        async function initializeReferralSystem() {
            const referralCode = getReferralCode();

            if (referralCode) {
                console.log('Processing referral code:', referralCode);
                const userData = await fetchUserByReferralCode(referralCode);

                // Initialize app banner with referral code
                initializeAppBanner(referralCode);
            } else {
                console.log('No referral code found in URL');

                // Initialize app banner without referral code
                initializeAppBanner(null);
            }
        }

        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Intersection Observer for scroll animations
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('revealed');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.reveal-on-scroll').forEach(el => {
            observer.observe(el);
        });

        // Initialize systems when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initializeReferralSystem();
            updateCTAs();
        });
    </script>
</body>

</html>