const translations = {
  en: {
    milestoneDirectTitle: "ðŸŽ‰ Amazing Progress!",
    milestoneDirectMessage: "Congratulations, {firstName}! You've reached {directCount} direct sponsors! Just {remainingTeam} more team member{pluralTeam} needed to unlock your {bizName} invitation. Keep building!",
    milestoneTeamTitle: "ðŸš€ Incredible Growth!",
    milestoneTeamMessage: "Amazing progress, {firstName}! You've built a team of {teamCount}! Just {remainingDirect} more direct sponsor{pluralDirect} needed to qualify for {bizName}. You're so close!",

    subscriptionActiveTitle: "âœ… Subscription Active",
    subscriptionActiveMessage: "Your subscription is now active until {expiryDate}.",
    subscriptionCancelledTitle: "âš ï¸ Subscription Cancelled",
    subscriptionCancelledMessage: "Your subscription has been cancelled but remains active until {expiryDate}.",
    subscriptionExpiredTitle: "âŒ Subscription Expired",
    subscriptionExpiredMessage: "Your subscription has expired. Renew now to keep building your team and accessing all recruiting tools.",
    subscriptionExpiringSoonTitle: "â° Subscription Expiring Soon",
    subscriptionExpiringSoonMessage: "Your subscription expires on {expiryDate}. Renew now to avoid interruption.",
    subscriptionPausedTitle: "â¸ï¸ Subscription Paused",
    subscriptionPausedMessage: "Your subscription has been paused. Resume in the App Store to restore access to all features.",
    subscriptionPaymentIssueTitle: "âš ï¸ Payment Issue",
    subscriptionPaymentIssueMessage: "Your subscription is on hold due to a payment issue. Please update your payment method in the App Store.",

    chatMessageTitle: "New Message from {senderName}",
    teamActivityTitle: "ðŸ‘€ Team Member Activity",
    teamActivityMessage: "{firstName} {lastName} from your team visited their {bizName} link!",
    bizOppCompletionTitle: "ðŸŽ‰ Team Member Joined {bizName}!",
    bizOppCompletionMessage: "{firstName} {lastName} completed their {bizName} registration! Welcome them to the opportunity and help them get started.",
    bizOppReminder24hTitle: "Complete Your Registration",
    bizOppReminder24hMessage: "You're one step away! Add your {bizName} referral link to start building your team. Click here to learn more!",
    bizOppReminder72hTitle: "Don't Miss Out!",
    bizOppReminder72hMessage: "Complete your {bizName} registration to unlock team building. Click here to learn more!",
    bizOppReminder168hTitle: "Final Reminder",
    bizOppReminder168hMessage: "Your {bizName} registration is still incomplete. Add your referral link now! Click here to learn more!",

    // Profile completion reminders
    profileReminder24hTitle: "Complete Your Profile",
    profileReminder24hMessage: "You're almost there! Add your photo and location to start building your team with Team Build Pro.",
    profileReminder72hTitle: "Your Team is Waiting!",
    profileReminder72hMessage: "Complete your profile setup to unlock all Team Build Pro features and start recruiting.",
    profileReminder168hTitle: "Don't Miss Out!",
    profileReminder168hMessage: "Your profile is incomplete. Finish setup now to access AI recruiting tools and build your downline!",
  },

  es: {
    milestoneDirectTitle: "ðŸŽ‰ Â¡Progreso IncreÃ­ble!",
    milestoneDirectMessage: "Â¡Felicidades, {firstName}! Â¡Has alcanzado {directCount} patrocinadores directos! Solo {remainingTeam} miembro{pluralTeam} mÃ¡s del equipo necesario para desbloquear tu invitaciÃ³n a {bizName}. Â¡Sigue construyendo!",
    milestoneTeamTitle: "ðŸš€ Â¡Crecimiento IncreÃ­ble!",
    milestoneTeamMessage: "Â¡Progreso asombroso, {firstName}! Â¡Has construido un equipo de {teamCount}! Solo {remainingDirect} patrocinador{pluralDirect} directo mÃ¡s necesario para calificar para {bizName}. Â¡EstÃ¡s muy cerca!",

    subscriptionActiveTitle: "âœ… SuscripciÃ³n Activa",
    subscriptionActiveMessage: "Tu suscripciÃ³n estÃ¡ ahora activa hasta {expiryDate}.",
    subscriptionCancelledTitle: "âš ï¸ SuscripciÃ³n Cancelada",
    subscriptionCancelledMessage: "Tu suscripciÃ³n ha sido cancelada pero permanece activa hasta {expiryDate}.",
    subscriptionExpiredTitle: "âŒ SuscripciÃ³n Expirada",
    subscriptionExpiredMessage: "Tu suscripciÃ³n ha expirado. Renueva ahora para seguir construyendo tu equipo y accediendo a todas las herramientas de reclutamiento.",
    subscriptionExpiringSoonTitle: "â° SuscripciÃ³n Por Expirar",
    subscriptionExpiringSoonMessage: "Tu suscripciÃ³n expira el {expiryDate}. Renueva ahora para evitar interrupciones.",
    subscriptionPausedTitle: "â¸ï¸ SuscripciÃ³n Pausada",
    subscriptionPausedMessage: "Tu suscripciÃ³n ha sido pausada. Reanuda en el App Store para restaurar el acceso a todas las funciones.",
    subscriptionPaymentIssueTitle: "âš ï¸ Problema de Pago",
    subscriptionPaymentIssueMessage: "Tu suscripciÃ³n estÃ¡ en espera debido a un problema de pago. Por favor actualiza tu mÃ©todo de pago en el App Store.",

    chatMessageTitle: "Nuevo Mensaje de {senderName}",
    teamActivityTitle: "ðŸ‘€ Actividad del Miembro del Equipo",
    teamActivityMessage: "Â¡{firstName} {lastName} de tu equipo visitÃ³ su enlace de {bizName}!",
    bizOppCompletionTitle: "ðŸŽ‰ Â¡Miembro del Equipo se UniÃ³ a {bizName}!",
    bizOppCompletionMessage: "Â¡{firstName} {lastName} completÃ³ su registro en {bizName}! Dales la bienvenida a la oportunidad y ayÃºdales a comenzar.",
    bizOppReminder24hTitle: "Completa Tu Registro",
    bizOppReminder24hMessage: "Â¡EstÃ¡s a un paso! Agrega tu enlace de referencia de {bizName} para comenzar a construir tu equipo. Â¡Haz clic aquÃ­ para obtener mÃ¡s informaciÃ³n!",
    bizOppReminder72hTitle: "Â¡No Te Lo Pierdas!",
    bizOppReminder72hMessage: "Completa tu registro en {bizName} para desbloquear la construcciÃ³n de equipos. Â¡Haz clic aquÃ­ para obtener mÃ¡s informaciÃ³n!",
    bizOppReminder168hTitle: "Recordatorio Final",
    bizOppReminder168hMessage: "Tu registro en {bizName} aÃºn estÃ¡ incompleto. Â¡Agrega tu enlace de referencia ahora! Â¡Haz clic aquÃ­ para obtener mÃ¡s informaciÃ³n!",

    // Profile completion reminders
    profileReminder24hTitle: "Completa Tu Perfil",
    profileReminder24hMessage: "Â¡Ya casi llegas! Agrega tu foto y ubicaciÃ³n para comenzar a construir tu equipo con Team Build Pro.",
    profileReminder72hTitle: "Â¡Tu Equipo Te Espera!",
    profileReminder72hMessage: "Completa la configuraciÃ³n de tu perfil para desbloquear todas las funciones de Team Build Pro y comenzar a reclutar.",
    profileReminder168hTitle: "Â¡No Te Lo Pierdas!",
    profileReminder168hMessage: "Tu perfil estÃ¡ incompleto. Â¡Termina la configuraciÃ³n ahora para acceder a herramientas de reclutamiento con IA y construir tu red!",
  },

  pt: {
    milestoneDirectTitle: "ðŸŽ‰ Progresso IncrÃ­vel!",
    milestoneDirectMessage: "ParabÃ©ns, {firstName}! VocÃª alcanÃ§ou {directCount} patrocinadores diretos! Apenas {remainingTeam} membro{pluralTeam} da equipe necessÃ¡rio para desbloquear seu convite para {bizName}. Continue construindo!",
    milestoneTeamTitle: "ðŸš€ Crescimento IncrÃ­vel!",
    milestoneTeamMessage: "Progresso incrÃ­vel, {firstName}! VocÃª construiu uma equipe de {teamCount}! Apenas {remainingDirect} patrocinador{pluralDirect} direto necessÃ¡rio para se qualificar para {bizName}. VocÃª estÃ¡ muito perto!",

    subscriptionActiveTitle: "âœ… Assinatura Ativa",
    subscriptionActiveMessage: "Sua assinatura estÃ¡ ativa atÃ© {expiryDate}.",
    subscriptionCancelledTitle: "âš ï¸ Assinatura Cancelada",
    subscriptionCancelledMessage: "Sua assinatura foi cancelada, mas permanece ativa atÃ© {expiryDate}.",
    subscriptionExpiredTitle: "âŒ Assinatura Expirada",
    subscriptionExpiredMessage: "Sua assinatura expirou. Renove agora para continuar construindo sua equipe e acessando todas as ferramentas de recrutamento.",
    subscriptionExpiringSoonTitle: "â° Assinatura Expirando Em Breve",
    subscriptionExpiringSoonMessage: "Sua assinatura expira em {expiryDate}. Renove agora para evitar interrupÃ§Ãµes.",
    subscriptionPausedTitle: "â¸ï¸ Assinatura Pausada",
    subscriptionPausedMessage: "Sua assinatura foi pausada. Retome na App Store para restaurar o acesso a todos os recursos.",
    subscriptionPaymentIssueTitle: "âš ï¸ Problema de Pagamento",
    subscriptionPaymentIssueMessage: "Sua assinatura estÃ¡ em espera devido a um problema de pagamento. Por favor, atualize seu mÃ©todo de pagamento na App Store.",

    chatMessageTitle: "Nova Mensagem de {senderName}",
    teamActivityTitle: "ðŸ‘€ Atividade do Membro da Equipe",
    teamActivityMessage: "{firstName} {lastName} da sua equipe visitou o link de {bizName}!",
    bizOppCompletionTitle: "ðŸŽ‰ Membro da Equipe Entrou em {bizName}!",
    bizOppCompletionMessage: "{firstName} {lastName} completou o registro em {bizName}! DÃª as boas-vindas Ã  oportunidade e ajude-os a comeÃ§ar.",
    bizOppReminder24hTitle: "Complete Seu Registro",
    bizOppReminder24hMessage: "VocÃª estÃ¡ a um passo! Adicione seu link de referÃªncia {bizName} para comeÃ§ar a construir sua equipe. Clique aqui para saber mais!",
    bizOppReminder72hTitle: "NÃ£o Perca!",
    bizOppReminder72hMessage: "Complete seu registro em {bizName} para desbloquear a construÃ§Ã£o de equipes. Clique aqui para saber mais!",
    bizOppReminder168hTitle: "Lembrete Final",
    bizOppReminder168hMessage: "Seu registro em {bizName} ainda estÃ¡ incompleto. Adicione seu link de referÃªncia agora! Clique aqui para saber mais!",

    // Profile completion reminders
    profileReminder24hTitle: "Complete Seu Perfil",
    profileReminder24hMessage: "VocÃª estÃ¡ quase lÃ¡! Adicione sua foto e localizaÃ§Ã£o para comeÃ§ar a construir sua equipe com o Team Build Pro.",
    profileReminder72hTitle: "Sua Equipe EstÃ¡ Esperando!",
    profileReminder72hMessage: "Complete a configuraÃ§Ã£o do seu perfil para desbloquear todos os recursos do Team Build Pro e comeÃ§ar a recrutar.",
    profileReminder168hTitle: "NÃ£o Perca!",
    profileReminder168hMessage: "Seu perfil estÃ¡ incompleto. Termine a configuraÃ§Ã£o agora para acessar ferramentas de recrutamento com IA e construir sua rede!",
  },

  de: {
    milestoneDirectTitle: "ðŸŽ‰ Erstaunlicher Fortschritt!",
    milestoneDirectMessage: "Herzlichen GlÃ¼ckwunsch, {firstName}! Sie haben {directCount} direkte Sponsoren erreicht! Nur noch {remainingTeam} Teammitglied{pluralTeam} benÃ¶tigt, um Ihre {bizName}-Einladung freizuschalten. Machen Sie weiter!",
    milestoneTeamTitle: "ðŸš€ Unglaubliches Wachstum!",
    milestoneTeamMessage: "Erstaunlicher Fortschritt, {firstName}! Sie haben ein Team von {teamCount} aufgebaut! Nur noch {remainingDirect} direkter Sponsor{pluralDirect} benÃ¶tigt, um sich fÃ¼r {bizName} zu qualifizieren. Sie sind so nah dran!",

    subscriptionActiveTitle: "âœ… Abonnement Aktiv",
    subscriptionActiveMessage: "Ihr Abonnement ist jetzt bis {expiryDate} aktiv.",
    subscriptionCancelledTitle: "âš ï¸ Abonnement GekÃ¼ndigt",
    subscriptionCancelledMessage: "Ihr Abonnement wurde gekÃ¼ndigt, bleibt aber bis {expiryDate} aktiv.",
    subscriptionExpiredTitle: "âŒ Abonnement Abgelaufen",
    subscriptionExpiredMessage: "Ihr Abonnement ist abgelaufen. Erneuern Sie jetzt, um Ihr Team weiter aufzubauen und auf alle Recruiting-Tools zuzugreifen.",
    subscriptionExpiringSoonTitle: "â° Abonnement LÃ¤uft Bald Ab",
    subscriptionExpiringSoonMessage: "Ihr Abonnement lÃ¤uft am {expiryDate} ab. Erneuern Sie jetzt, um Unterbrechungen zu vermeiden.",
    subscriptionPausedTitle: "â¸ï¸ Abonnement Pausiert",
    subscriptionPausedMessage: "Ihr Abonnement wurde pausiert. Setzen Sie es im App Store fort, um den Zugriff auf alle Funktionen wiederherzustellen.",
    subscriptionPaymentIssueTitle: "âš ï¸ Zahlungsproblem",
    subscriptionPaymentIssueMessage: "Ihr Abonnement ist aufgrund eines Zahlungsproblems gesperrt. Bitte aktualisieren Sie Ihre Zahlungsmethode im App Store.",

    chatMessageTitle: "Neue Nachricht von {senderName}",
    teamActivityTitle: "ðŸ‘€ Teammitglied-AktivitÃ¤t",
    teamActivityMessage: "{firstName} {lastName} aus Ihrem Team hat ihren {bizName}-Link besucht!",
    bizOppCompletionTitle: "ðŸŽ‰ Teammitglied ist {bizName} beigetreten!",
    bizOppCompletionMessage: "{firstName} {lastName} hat die {bizName}-Registrierung abgeschlossen! HeiÃŸen Sie sie in der Gelegenheit willkommen und helfen Sie ihnen beim Einstieg.",
    bizOppReminder24hTitle: "SchlieÃŸen Sie Ihre Registrierung Ab",
    bizOppReminder24hMessage: "Sie sind nur einen Schritt entfernt! FÃ¼gen Sie Ihren {bizName}-Empfehlungslink hinzu, um mit dem Teamaufbau zu beginnen. Klicken Sie hier, um mehr zu erfahren!",
    bizOppReminder72hTitle: "Verpassen Sie Es Nicht!",
    bizOppReminder72hMessage: "SchlieÃŸen Sie Ihre {bizName}-Registrierung ab, um den Teamaufbau freizuschalten. Klicken Sie hier, um mehr zu erfahren!",
    bizOppReminder168hTitle: "Letzte Erinnerung",
    bizOppReminder168hMessage: "Ihre {bizName}-Registrierung ist noch unvollstÃ¤ndig. FÃ¼gen Sie jetzt Ihren Empfehlungslink hinzu! Klicken Sie hier, um mehr zu erfahren!",

    // Profile completion reminders
    profileReminder24hTitle: "VervollstÃ¤ndigen Sie Ihr Profil",
    profileReminder24hMessage: "Sie sind fast da! FÃ¼gen Sie Ihr Foto und Ihren Standort hinzu, um mit Team Build Pro Ihr Team aufzubauen.",
    profileReminder72hTitle: "Ihr Team Wartet!",
    profileReminder72hMessage: "SchlieÃŸen Sie Ihre Profileinrichtung ab, um alle Team Build Pro-Funktionen freizuschalten und mit dem Recruiting zu beginnen.",
    profileReminder168hTitle: "Verpassen Sie Es Nicht!",
    profileReminder168hMessage: "Ihr Profil ist unvollstÃ¤ndig. SchlieÃŸen Sie die Einrichtung jetzt ab, um auf KI-Recruiting-Tools zuzugreifen und Ihr Netzwerk aufzubauen!",
  },
};

function getTranslation(key, lang = 'en', params = {}) {
  const langCode = normalizeLanguageCode(lang);
  const langTranslations = translations[langCode] || translations.en;
  let text = langTranslations[key] || translations.en[key] || key;

  Object.keys(params).forEach(paramKey => {
    const placeholder = `{${paramKey}}`;
    text = text.replace(new RegExp(placeholder, 'g'), params[paramKey]);
  });

  return text;
}

function normalizeLanguageCode(lang) {
  if (!lang) return 'en';

  const code = lang.toLowerCase().split(/[-_]/)[0];

  const validLanguages = ['en', 'es', 'pt', 'de'];
  return validLanguages.includes(code) ? code : 'en';
}

function getNotificationText(key, lang, params = {}) {
  return getTranslation(key, lang, params);
}

module.exports = {
  getTranslation,
  getNotificationText,
  normalizeLanguageCode,
  translations,
};
